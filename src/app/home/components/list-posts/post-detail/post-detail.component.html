<div class="container-fluid bg-light">
  <div class="row" style="height: 10%">
    <label style="font-size: 30px">[{{post.postType.name}}] {{post.title}}</label>
  </div>
  <hr style="margin-bottom: 3vh; margin-top: 0">

  <div class="row">
    <div id="carouselExampleCaptions" class="carousel slide col-6" data-ride="carousel">
      <ol class="carousel-indicators">
        <li data-target="#carouselExampleCaptions" *ngFor="let image of post.postImages; index as i"
            [attr.data-slide-to]="i"></li>
      </ol>
      <div class="carousel-inner">
        <div class="carousel-item" *ngFor="let image of post.postImages; let isFirst = first"
             [ngClass]="{active:isFirst}">
          <img [src]="'../../../../../assets/img/'+image.image" class="d-block w-100" height="350">
        </div>
      </div>
      <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>
    <div class="col-6">
      <div class="row">
        <label class="col-4">Ngày đăng:</label>
        <label class="col-8">{{post.createdAt | date: "dd/MM/yyyy"}}</label>
      </div>
      <div class="row">
        <label class="col-4">Vùng miền:</label>
        <label class="col-8">{{post.region.name}}</label>
      </div>
      <div class="row">
        <label class="col-4">Hướng:</label>
        <label class="col-8">{{post.direction.name}}</label>
      </div>
      <div class="row">
        <label class="col-4">Tình trạng:</label>
        <div *ngIf="post.condition; else notShow">
          <label class="col-8">Mới</label>
        </div>
        <ng-template #notShow>
          <label class="col-8">Đã qua sử dụng</label>
        </ng-template>
      </div>
      <div class="row">
        <label class="col-4">Địa chỉ:</label>
        <label class="col-8">{{post.address}}</label>
      </div>
      <div class="row">
        <label class="col-4">Diện tích:</label>
        <label class="col-8">{{post.area}} m<sup>2</sup></label>
      </div>
      <div class="row">
        <label class="col-4">Giá:</label>
        <label class="col-8">{{post.price}} VNĐ</label>
      </div>
      <div class="row">
        <label class="col-4">Lượt xem:</label>
        <label class="col-8">{{post.viewCount}}</label>
      </div>
    </div>
  </div>
  <div class="row my-3">
    <div style="width: 1vh; background-color: red; margin-right: 3vh"></div>
    <div class="notice notice-danger"><label style="font-size: 30px">{{post.content}}</label>
    </div>
  </div>
  <div class="my-3" style="font-size: small">
    <div class="row">
      <label>Thông tin liên hệ</label>
    </div>
    <hr style="margin-bottom: 3vh; margin-top: 0">
    <div>
      <div class="row">
        <label class="col-2">Họ và tên:</label>
        <label class="col-10">{{post.user.name}}</label>
      </div>
      <div class="row">
        <label class="col-2">Email:</label>
        <label class="col-10">{{post.user.email}}</label>
      </div>
      <div class="row">
        <label class="col-2">Số điện thoại:</label>
        <label class="col-10">{{post.user.phoneNumber}}</label>
      </div>
      <div class="row">
        <label class="col-2">Địa chỉ:</label>
        <label class="col-10">{{post.user.address}}</label>
      </div>
    </div>
  </div>
  <div>
    <div class="row">
      <label>Bình luận</label>
    </div>
    <hr style="margin-bottom: 3vh; margin-top: 0">
    <form [formGroup]="comment" (ngSubmit)="commentSubmit()">
      <div class="row">
        <div class="col-1 d-flex justify-content-center">
          <img src="../../../../../assets/img/{{user.avatar}}" style="width: 60px; height: 60px; border-radius: 50%"/>
        </div>
        <div class=" col-11">
          <textarea rows="3" style="width: 100%" formControlName="content"></textarea>
        </div>
      </div>
      <div class="d-flex justify-content-end">
        <button class="btn btn-outline-success">Bình luận</button>
      </div>
    </form>
    <div *ngFor="let comment of comments; index as i">
      <ng-container *ngIf="comment.status">
        <div class="row my-2">
          <div class="col-1">
            <img src="../../../../../assets/img/{{comment.user.avatar}}"
                 style="width: 50px; height: 50px; border-radius: 50%">
            <span class="badge badge-info" style="cursor: pointer" (click)="isShowReply = true; indexComment = i">Trả lời</span>
          </div>
          <div class="col-11 dropdown">
            <ng-container *ngIf="!isShowEditFormComment">
              <div class="mb-3 pl-2" style="border: 1px solid #d8d8d8">
                <label>{{comment.user.email}}</label>
                <label style="font-style: italic; font-size: smaller; margin-left: 1%">Đã bình luận
                  vào: {{comment.createdAt | date: "dd/MM/yyyy"}}</label>
                <div class="d-flex">
                  <div>{{comment.content}}</div>
                  <ng-container *ngIf="comment.user.id == user.id">
                    <div class="dropdown-content">
                      <span class="_54nc" (click)="showEditComment(i, comment)">Sửa</span>
                      <span class="_54nc" (click)="deleteComment(comment.id)">Xóa</span>
                    </div>
                  </ng-container>
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="isShowEditFormComment && indexComment == i">
              <textarea rows="3" style="width: 100%" [(ngModel)]="edit"></textarea>
              <div class="d-flex justify-content-end">
                <button class="mx-2 btn btn-outline-dark btn-sm" (click)="isShowEditFormComment = false">Hủy</button>
                <button class="mx-2 btn btn-outline-success btn-sm" (click)="editComment(comment)">Sửa</button>
              </div>
            </ng-container>
            <ng-container *ngIf="isShowEditFormComment && indexComment != i">
              <div style="border: 1px solid #d8d8d8">
                <label>{{comment.user.email}}</label>
                <label style="font-style: italic; font-size: smaller; margin-left: 1%">Đã bình luận
                  vào: {{comment.createdAt | date: "dd/MM/yyyy"}}</label>
                <div class="d-flex">
                  <div>{{comment.content}}</div>
                </div>
              </div>
            </ng-container>
            <div *ngIf="isShowReply && i == indexComment">
              <form [formGroup]="reply">
                <div class="row">
                  <div class="col-1">
                    <img src="../../../../../assets/img/{{user.avatar}}"
                         style="width: 50px; height: 50px; border-radius: 50%"/>
                  </div>
                  <div class=" col-11">
                    <textarea rows="3" style="width: 100%" formControlName="content"></textarea>
                  </div>
                </div>
                <div class="d-flex justify-content-end">
                  <button class="mx-2 btn btn-outline-dark btn-sm" (click)="isShowReply = false">Hủy</button>
                  <button class="mx-2 btn btn-outline-success btn-sm" (click)="replySubmit(comment)">Trả lời</button>
                </div>
              </form>
            </div>
              <div *ngFor="let reply of comment.replies; index as y">
                <ng-container *ngIf="reply.status">
                  <div class="row my-2">
                    <div class="col-1">
                      <img src="../../../../../assets/img/{{reply.user.avatar}}"
                           style="width: 50px; height: 50px; border-radius: 50%">
                    </div>
                    <div class="col-11 dropdown">
                      <ng-container *ngIf="!isShowEditFormReply">
                        <div class="pl-2" style="border: 1px solid #d8d8d8">
                          <label>{{reply.user.email}}</label>
                          <label style="font-style: italic; font-size: smaller; margin-left: 1%">Đã bình luận
                            vào: {{reply.createdAt | date: "dd/MM/yyyy"}}</label>
                          <div class="d-flex">
                            <div>{{reply.content}}</div>
                            <ng-container *ngIf="reply.user.id == user.id">
                              <div class="dropdown-content">
                                <span class="_54nc" (click)="showEditReply(i, y, comment, reply)">Sửa</span>
                                <span class="_54nc" (click)="deleteReply(reply.id)">Xóa</span>
                              </div>
                            </ng-container>
                          </div>
                        </div>
                      </ng-container>
                      <ng-container *ngIf="isShowEditFormReply && indexReply == y && indexComment == i">
                        <textarea rows="3" style="width: 100%" [(ngModel)]="edit"></textarea>
                        <div class="d-flex justify-content-end">
                          <button class="mx-2 btn btn-outline-dark btn-sm" (click)="isShowEditFormReply = false">Hủy
                          </button>
                          <button class="mx-2 btn btn-outline-success btn-sm" (click)="editReply(reply, comment)">Sửa
                          </button>
                        </div>
                      </ng-container>
                      <ng-container *ngIf="isShowEditFormReply && (indexReply != y || indexComment != i)">
                        <div style="border: 1px solid #d8d8d8">
                          <label>{{reply.user.email}}</label>
                          <label style="font-style: italic; font-size: smaller; margin-left: 1%">Đã bình luận
                            vào: {{reply.createdAt | date: "dd/MM/yyyy"}}</label>
                          <div class="d-flex">
                            <div>{{reply.content}}</div>
                          </div>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </ng-container>
              </div>
          </div>
        </div>
      </ng-container>
    </div>
    <div class="d-flex justify-content-center">
      <!--      <ngb-pagination   [(page)]="page"-->
      <!--                        [pageSize]="pageSize"-->
      <!--                        [collectionSize]="comments.length">-->
      <!--        <button class="btn btn-outline-info">Previous</button>-->
      <!--        <button class="btn btn-outline-info">1</button>-->
      <!--        <button class="btn btn-outline-info">Next</button>-->

      <!--        <ng-template ngbPaginationFirst>First</ng-template>-->
      <!--        <ng-template ngbPaginationLast>Last</ng-template>-->
      <!--        <ng-template ngbPaginationPrevious>Prev</ng-template>-->
      <!--        <ng-template ngbPaginationNext>Next</ng-template>-->
      <!--        <ng-template ngbPaginationEllipsis>...</ng-template>-->
      <!--        <ng-template ngbPaginationNumber let-page>{{ page }}</ng-template>-->
      <!--        <a th:href="@{'/khuyen-mai'(page=${khuyenMais.number - 1})}" th:if="${khuyenMais.hasPrevious()}" class="badge badge-primary">Previous</a>-->
      <!--        <span th:if="${khuyenMais.hasContent()}">-->
      <!--        <span th:text="${khuyenMais.number + 1}"></span>/<span th:text="${khuyenMais.totalPages}"></span>-->
      <!--    </span>-->
      <!--        <a th:href="@{'/khuyen-mai'(page=${khuyenMais.number + 1})}" th:if="${khuyenMais.hasNext()}" class="badge badge-primary">Next</a>-->
      <!--      </ngb-pagination>-->
    </div>
  </div>
</div>
